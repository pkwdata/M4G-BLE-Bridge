menu "M4G Settings Configuration"

    config M4G_SETTINGS_ENABLE_NVS_PERSISTENCE
        bool "Enable NVS persistence for runtime settings"
        default y
        help
            When enabled, settings can be modified at runtime and saved to NVS.
            Persisted settings survive reboots. When disabled, only compile-time
            Kconfig defaults are used.

    menu "Chord Detection Settings"

        config M4G_CHORD_DELAY_MS_DEFAULT
            int "CharaChorder output detection delay (ms)"
            default 15
            range 10 50
            help
                Time to wait for CharaChorder firmware to send chord output after key release.
                CharaChorder uses ~10-25ms for output generation. Setting this too low may
                cause chords to be sent as individual keys; too high adds perceptible latency.
                
                Based on CharaChorder DeviceManager analysis:
                - 15ms: Fast response, reliable for most users
                - 25ms: More tolerance for slower CharaChorder firmware
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

        config M4G_CHORD_TIMEOUT_MS_DEFAULT
            int "Single-key chord timeout (ms)"
            default 500
            range 100 2000
            help
                Time to wait before emitting a single held key to enable key repeat.
                If a single key is held in the chord buffer for this duration without
                release or additional keys, it will be emitted to allow OS/firmware repeat.
                
                Based on CharaChorder DeviceManager analysis:
                - 500ms: Good balance - allows chord detection while enabling repeat
                - 1000ms: Longer delay before repeat can start
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

        config M4G_CHORD_PRESS_DEVIATION_MAX_MS_DEFAULT
            int "Maximum press deviation for chord detection (ms)"
            default 100
            range 20 500
            help
                Maximum time spread between first and last key press in a chord.
                CharaChorder considers <25ms * key_count as acceptable quality.
                
                For 4-key chords: 100ms is the upper acceptable limit.
                For perfect quality: 40ms (10ms * 4 keys)
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

        config M4G_CHORD_RELEASE_DEVIATION_MAX_MS_DEFAULT
            int "Maximum release deviation for chord detection (ms)"
            default 72
            range 20 300
            help
                Maximum time spread between first and last key release in a chord.
                CharaChorder considers <18ms * key_count as acceptable quality.
                
                For 4-key chords: 72ms is the upper acceptable limit.
                For perfect quality: 40ms (10ms * 4 keys)
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

    endmenu

    menu "Key Repeat Settings"

        config M4G_ENABLE_KEY_REPEAT
            bool "Enable key repeat functionality"
            default y
            help
                Enable key repeat for held keys. When a single key is held for longer
                than the chord timeout (500ms), it will be emitted and repeat will start.
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

        config M4G_KEY_REPEAT_DELAY_MS_DEFAULT
            int "Key repeat initial delay (ms)"
            default 1000
            range 250 2000
            help
                Time a key must be held before repeating starts.
                Standard OS default is 1000ms (Windows/Linux).
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

        config M4G_KEY_REPEAT_RATE_MS_DEFAULT
            int "Key repeat rate (ms between repeats)"
            default 33
            range 16 200
            help
                Time between repeated key events once repeat has started.
                
                Common values:
                - 33ms: ~30 Hz (Windows default)
                - 50ms: ~20 Hz (slower repeat)
                - 16ms: ~60 Hz (very fast)
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

    endmenu

    menu "Feature Toggles"

        config M4G_RAW_MODE_DEFAULT
            bool "CharaChorder raw mode (disable chord processing)"
            default n
            help
                When enabled, all chord detection is bypassed and keys are passed
                through directly. This was causing issues when accidentally enabled.
                
                Only enable for debugging or if using CharaChorder as a regular keyboard.
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

        config M4G_DUPLICATE_SUPPRESSION_DEFAULT
            bool "Enable duplicate report suppression"
            default y
            help
                Suppress sending identical consecutive HID reports.
                Reduces BLE bandwidth and improves battery life.
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

        config M4G_CHORD_DEVIATION_TRACKING_DEFAULT
            bool "Enable chord quality deviation tracking"
            default n
            help
                Track and log chord quality metrics (press/release deviation).
                Useful for diagnostics and tuning chord detection parameters.
                
                Based on CharaChorder DeviceManager analysis:
                - Press deviation: time spread of key presses
                - Release deviation: time spread of key releases
                
                Adds logging overhead but provides valuable quality metrics.
                
                This is the DEFAULT value. Can be changed at runtime if NVS persistence enabled.

    endmenu

    config M4G_SETTINGS_RESET_ON_BOOT
        bool "Reset settings to defaults on next boot"
        default n
        help
            Enable this temporarily to reset all NVS-stored settings to their
            Kconfig defaults on the next boot. Will automatically disable itself
            after reset is complete.
            
            Use this if settings become corrupted or you want to start fresh.

endmenu
